import wandb
import matplotlib.pyplot as plt
import numpy as np

plt.rcParams['text.usetex'] = True

params = {"ytick.color" : "black",
          "xtick.color" : "black",
          "axes.labelcolor" : "black",
          "axes.edgecolor" : "black",
          "text.usetex" : True,
          "font.family" : "serif",
          "font.serif" : ["Computer Modern Serif"]}
plt.rcParams.update(params)

colors = ["forestgreen", "limegreen", "pink", "orange"]
fontsize = 20
lw = 3.0

fig, ax = plt.subplots(figsize=(14,10))

ax.hlines(y=0.0, xmin=0.0, xmax=2*np.pi, lw=lw, color="red")

api = wandb.Api()


# epochs
# data_dict = {
#     "SO(3) invariant + circular": {
#         "losses": [0.0, 2.9188715870986925e-06, 9.121234143094625e-06, 1.3919475350121502e-05, 1.30598564282991e-05, 1.0422268132970203e-05, 1.0492614819668233e-05, 1.419578620698303e-05, 2.1019834093749523e-05, 3.182341970386915e-05, 4.15573813370429e-05, 4.260438072378747e-05, 3.73929797206074e-05, 3.513530100462958e-05, 3.5396235034568235e-05, 3.2846088288351893e-05, 2.8881077014375478e-05, 3.0542891181539744e-05, 3.5833312722388655e-05, 3.70798006770201e-05, 3.5100048989988863e-05, 3.302995173726231e-05, 3.0776096537010744e-05, 2.8807175112888217e-05, 2.9026570700807497e-05, 3.548429231159389e-05, 4.3019714212277904e-05, 4.5267319364938885e-05, 4.624074790626764e-05, 4.5632044930243865e-05, 4.243558942107484e-05, 3.891482265316881e-05, 3.368304896866903e-05, 3.074692722293548e-05, 2.8937880415469408e-05, 2.8340609787846915e-05, 2.9307555450941436e-05, 2.9865816031815484e-05, 3.117316373391077e-05, 3.126540104858577e-05, 3.1106457754503936e-05, 3.172051583533175e-05, 3.356876186444424e-05, 3.825334715656936e-05, 4.261777939973399e-05, 4.0514722059015185e-05, 3.3055614039767534e-05, 2.3407537810271606e-05, 1.1357228686392773e-05, 1.9977901501988526e-06, 2.2906127128408116e-07, 4.409686880535446e-06, 1.0673635188140906e-05, 1.421698289050255e-05, 1.225047162733972e-05, 1.0088292583532166e-05, 1.1138332411064766e-05, 1.5547568182228133e-05, 2.3384287487715483e-05, 3.461078449618071e-05, 4.280567372916266e-05, 4.166544385952875e-05, 3.628516788012348e-05, 3.5103301343042403e-05, 3.506376742734574e-05, 3.184594606864266e-05, 2.864930866053328e-05, 3.182767250109464e-05, 3.6916204408043995e-05, 3.678224311443046e-05, 3.4305274311918765e-05, 3.208884663763456e-05, 3.0506385883199982e-05, 2.8016329451929778e-05, 2.9886201446061023e-05, 3.7598394555971026e-05, 4.4078085920773447e-05, 4.5565397158497944e-05, 4.630603871191852e-05, 4.4984677515458316e-05, 4.14702772104647e-05, 3.767095768125728e-05, 3.2759635359980166e-05, 3.0183886337908916e-05, 2.872591903724242e-05, 2.8386315534589812e-05, 2.9407023248495534e-05, 3.0090905056567863e-05, 3.125734656350687e-05, 3.1288000172935426e-05, 3.1242845579981804e-05, 3.153010766254738e-05, 3.472841490292922e-05, 3.9309452404268086e-05, 4.299326246837154e-05, 3.928942896891385e-05, 3.060973176616244e-05, 2.069782931357622e-05, 8.455125680484343e-06, 9.140448469224793e-07, 8.049555617617443e-07, 5.954306288913358e-06, 1.2067265743098687e-05, 1.3990962543175556e-05, 1.1593408999033272e-05, 1.0017710337706376e-05, 1.2005468306597322e-05, 1.7159733033622615e-05, 2.60357883234974e-05, 3.724841371877119e-05, 4.350368908490054e-05, 4.043363151140511e-05, 3.5420453059487045e-05, 3.5143417335348204e-05, 3.451049269642681e-05, 3.0782350222580135e-05, 2.9065186026855372e-05, 3.3420314139220864e-05, 3.727935836650431e-05, 3.6691453715320677e-05, 3.3473661460448056e-05, 3.1754098017700016e-05, 2.983837475767359e-05, 2.815623884089291e-05, 3.1265997677110136e-05, 3.977435335400514e-05, 4.474585148273036e-05, 4.599316162057221e-05, 4.632542913896032e-05, 4.369685484562069e-05, 4.050725692650303e-05, 3.6296634789323434e-05, 3.182797445333563e-05, 2.96409289148869e-05, 2.8600490622920915e-05, 2.8715163352899253e-05, 2.934565782197751e-05, 3.044296863663476e-05, 3.137225940008648e-05, 3.096732689300552e-05, 3.126850424450822e-05, 3.234549149055965e-05, 3.562786150723696e-05, 4.074123717145994e-05, 4.2783180106198415e-05, 3.7440797314047813e-05, 2.854614649550058e-05, 1.7638139979681e-05, 5.8449431890039705e-06, 2.2340890382110956e-07, 1.6936501197051257e-06, 7.639499926881399e-06, 1.3166858479962684e-05, 1.3618137927551288e-05, 1.0975738405250013e-05, 1.0171639587497339e-05, 1.3014603609917685e-05, 1.8974667909787968e-05, 2.883373417716939e-05, 3.942117473343387e-05, 4.338045255281031e-05, 3.887202910846099e-05, 3.4975695598404855e-05, 3.547112282831222e-05, 3.378817200427875e-05, 2.9887127311667427e-05, 2.9670445655938238e-05, 3.4681368560995907e-05, 3.7438505387399346e-05, 3.5999255487695336e-05, 3.3155720302602276e-05, 3.1393927201861516e-05, 2.930329537775833e-05, 2.8307153115747496e-05, 3.312846092740074e-05, 4.155506758252159e-05, 4.50506413471885e-05, 4.607502341968939e-05, 4.6083718189038336e-05, 4.31687876698561e-05, 3.9772610762156546e-05, 3.4838296414818615e-05, 3.123529313597828e-05, 2.9266491765156388e-05, 2.828866672643926e-05, 2.8878075681859627e-05, 2.9480934244929813e-05, 3.0845221772324294e-05, 3.12762895191554e-05, 3.098124579992145e-05, 3.1586980185238644e-05, 3.3097079722210765e-05, 3.699167427839711e-05, 4.173384149908088e-05, 4.190796607872471e-05, 3.537015072652139e-05, 2.602395397843793e-05, 1.4379574167833198e-05, 3.6438584629649995e-06, 8.691374578590275e-14],
#         "angles": [0.0, 0.03157379551346526, 0.06314759102693052, 0.09472138654039577, 0.12629518205386103, 0.1578689775673263, 0.18944277308079155, 0.2210165685942568, 0.25259036410772207, 0.28416415962118735, 0.3157379551346526, 0.3473117506481178, 0.3788855461615831, 0.4104593416750484, 0.4420331371885136, 0.47360693270197884, 0.5051807282154441, 0.5367545237289094, 0.5683283192423747, 0.5999021147558399, 0.6314759102693052, 0.6630497057827704, 0.6946235012962356, 0.7261972968097009, 0.7577710923231662, 0.7893448878366315, 0.8209186833500968, 0.8524924788635619, 0.8840662743770272, 0.9156400698904925, 0.9472138654039577, 0.978787660917423, 1.0103614564308883, 1.0419352519443534, 1.0735090474578188, 1.105082842971284, 1.1366566384847494, 1.1682304339982146, 1.1998042295116798, 1.2313780250251452, 1.2629518205386103, 1.2945256160520755, 1.326099411565541, 1.357673207079006, 1.3892470025924712, 1.4208207981059366, 1.4523945936194018, 1.4839683891328672, 1.5155421846463324, 1.5471159801597976, 1.578689775673263, 1.6102635711867281, 1.6418373667001935, 1.6734111622136587, 1.7049849577271239, 1.7365587532405893, 1.7681325487540545, 1.7997063442675196, 1.831280139780985, 1.8628539352944502, 1.8944277308079154, 1.9260015263213808, 1.957575321834846, 1.9891491173483113, 2.0207229128617765, 2.0522967083752417, 2.083870503888707, 2.1154442994021725, 2.1470180949156377, 2.178591890429103, 2.210165685942568, 2.241739481456033, 2.273313276969499, 2.304887072482964, 2.336460867996429, 2.3680346635098943, 2.3996084590233595, 2.4311822545368247, 2.4627560500502903, 2.4943298455637555, 2.5259036410772207, 2.557477436590686, 2.589051232104151, 2.6206250276176166, 2.652198823131082, 2.683772618644547, 2.715346414158012, 2.7469202096714773, 2.7784940051849425, 2.810067800698408, 2.8416415962118733, 2.8732153917253385, 2.9047891872388036, 2.936362982752269, 2.9679367782657344, 2.9995105737791996, 3.031084369292665, 3.06265816480613, 3.094231960319595, 3.1258057558330608, 3.157379551346526, 3.188953346859991, 3.2205271423734563, 3.2521009378869215, 3.283674733400387, 3.3152485289138522, 3.3468223244273174, 3.3783961199407826, 3.4099699154542478, 3.441543710967713, 3.4731175064811786, 3.5046913019946437, 3.536265097508109, 3.567838893021574, 3.5994126885350393, 3.630986484048505, 3.66256027956197, 3.6941340750754352, 3.7257078705889004, 3.7572816661023656, 3.7888554616158308, 3.8204292571292964, 3.8520030526427615, 3.8835768481562267, 3.915150643669692, 3.946724439183157, 3.9782982346966227, 4.009872030210087, 4.041445825723553, 4.073019621237019, 4.104593416750483, 4.136167212263949, 4.167741007777414, 4.199314803290879, 4.230888598804345, 4.26246239431781, 4.294036189831275, 4.32560998534474, 4.357183780858206, 4.388757576371671, 4.420331371885136, 4.451905167398602, 4.483478962912066, 4.515052758425532, 4.546626553938998, 4.578200349452462, 4.609774144965928, 4.641347940479393, 4.672921735992858, 4.704495531506323, 4.736069327019789, 4.767643122533254, 4.799216918046719, 4.830790713560185, 4.862364509073649, 4.893938304587115, 4.925512100100581, 4.957085895614045, 4.988659691127511, 5.020233486640976, 5.051807282154441, 5.083381077667907, 5.114954873181372, 5.146528668694837, 5.178102464208302, 5.209676259721768, 5.241250055235233, 5.272823850748698, 5.304397646262164, 5.335971441775628, 5.367545237289094, 5.39911903280256, 5.430692828316024, 5.46226662382949, 5.493840419342955, 5.52541421485642, 5.556988010369885, 5.588561805883351, 5.620135601396816, 5.651709396910281, 5.683283192423747, 5.714856987937211, 5.746430783450677, 5.7780045789641425, 5.809578374477607, 5.841152169991073, 5.872725965504538, 5.904299761018003, 5.935873556531469, 5.967447352044934, 5.999021147558399, 6.030594943071864, 6.06216873858533, 6.093742534098795, 6.12531632961226, 6.1568901251257255, 6.18846392063919, 6.220037716152656, 6.2516115116661215, 6.283185307179586]
#     },
#     "SO(3) invariant + square": {
#         "losses": [0.0, 4.41434167441912e-06, 1.3639799362863414e-05, 2.0682995454990305e-05, 2.064650834654458e-05, 2.1865231246920303e-05, 3.0089106076047756e-05, 4.6083445340627804e-05, 7.060095958877355e-05, 9.872993541648611e-05, 0.00012052575766574591, 0.00012541154865175486, 0.00012280803639441729, 0.00012411968782544136, 0.00012366262672003359, 0.00011860110680572689, 0.000114904047222808, 0.00011683408229146153, 0.00012131836410844699, 0.00011573111260076985, 0.00010340659355279058, 9.359855903312564e-05, 9.133774437941611e-05, 9.749102173373103e-05, 0.0001095368861570023, 0.0001244769082404673, 0.00013939960626885295, 0.0001433963334420696, 0.00014440476661548018, 0.00014732210547663271, 0.00014350080164149404, 0.000132738656247966, 0.00012391808559186757, 0.00011989336053375155, 0.0001118766886065714, 0.00010593962360871956, 9.914609108818695e-05, 9.02408646652475e-05, 8.305493975058198e-05, 7.468612602679059e-05, 6.988229870330542e-05, 7.164075213950127e-05, 7.683557487325743e-05, 8.57139311847277e-05, 9.627782128518447e-05, 9.622193465474993e-05, 8.205517224268988e-05, 5.5910684750415385e-05, 2.437766670482233e-05, 3.614354682213161e-06, 3.376531765297841e-07, 6.854868843220174e-06, 1.594233799551148e-05, 2.10991311178077e-05, 1.9880448235198855e-05, 2.338438389415387e-05, 3.2902727980399504e-05, 5.163457171875052e-05, 7.771699165459722e-05, 0.00010524622484808788, 0.00012273041647858918, 0.00012466339103411883, 0.0001234454393852502, 0.00012451008660718799, 0.00012300223170313984, 0.00011815420293714851, 0.00011550117051228881, 0.00011855775665026158, 0.00012267983402125537, 0.00011311803973512724, 0.00010059261694550514, 9.104375203605741e-05, 9.222821972798556e-05, 9.846567263593897e-05, 0.00011107519821962342, 0.00012830269406549633, 0.00014148182526696473, 0.00014453114999923855, 0.0001443011569790542, 0.00014645754708908498, 0.0001415177684975788, 0.00013084380771033466, 0.00012252022861503065, 0.00011840921069961041, 0.00011109116894658655, 0.0001034668312058784, 9.658736234996468e-05, 8.81099040270783e-05, 8.11510399216786e-05, 7.306012412300333e-05, 6.976176518946886e-05, 7.177531369961798e-05, 7.905765232862905e-05, 8.842848183121532e-05, 9.805690206121653e-05, 9.494771074969321e-05, 7.583515252918005e-05, 4.863916547037661e-05, 1.7324822692899033e-05, 1.5410792002512608e-06, 1.207752916343452e-06, 8.949047696660273e-06, 1.7960355762625113e-05, 2.1004623704357073e-05, 2.0043138647451997e-05, 2.5335149985039607e-05, 3.680848749354482e-05, 5.765716196037829e-05, 8.54757017805241e-05, 0.00011123896547360346, 0.00012500568118412048, 0.0001241089921677485, 0.00012338277883827686, 0.00012449550558812916, 0.00012141725892433897, 0.0001169861716334708, 0.00011490114411571994, 0.00012065940973116085, 0.00012083196634193882, 0.00011048106534872204, 9.68955791904591e-05, 9.040711302077398e-05, 9.328225860372186e-05, 0.00010181753168581054, 0.00011356667528161779, 0.0001335102424491197, 0.00014246668433770537, 0.00014310082769952714, 0.00014525061124004424, 0.0001447901886422187, 0.00013832325930707157, 0.0001267333864234388, 0.00012107432849006727, 0.00011603620077949017, 0.00010918991029029712, 0.00010220779222436249, 9.402584691997617e-05, 8.674363198224455e-05, 7.95861633378081e-05, 7.121457747416571e-05, 6.96026545483619e-05, 7.385984645225108e-05, 7.998566434253007e-05, 9.18866426218301e-05, 9.916198905557394e-05, 9.177085303235799e-05, 7.019864278845489e-05, 4.0114558942150325e-05, 1.1426365745137446e-05, 3.9550724295622786e-07, 2.511917273295694e-06, 1.1437635293987114e-05, 1.9573863028199412e-05, 2.0789204427273944e-05, 2.103377119055949e-05, 2.771247091004625e-05, 4.0997896576300263e-05, 6.41629085293971e-05, 9.239889914169908e-05, 0.00011661941243801266, 0.0001256857649423182, 0.000123491496196948, 0.00012420170241966844, 0.00012445214088074863, 0.00011950902262469754, 0.000115946852019988, 0.00011569236812647432, 0.0001211782218888402, 0.00011917620577150956, 0.00010713261144701391, 9.502437023911625e-05, 9.062518074642867e-05, 9.527392830932513e-05, 0.00010516945621930063, 0.00011796460603363812, 0.0001375143474433571, 0.00014263346383813769, 0.00014384101086761802, 0.0001458678743802011, 0.0001445481611881405, 0.000135943409986794, 0.00012498427531681955, 0.00011970446212217212, 0.0001142454711953178, 0.00010694432421587408, 0.00010078091872856021, 9.159868932329118e-05, 8.481516124447808e-05, 7.682575233047828e-05, 7.053613080643117e-05, 7.041172648314387e-05, 7.549484143964946e-05, 8.286150841740891e-05, 9.408769255969673e-05, 9.861047146841884e-05, 8.723440259927884e-05, 6.313621997833252e-05, 3.1719187973067164e-05, 6.774595476599643e-06, 7.2283390210869936e-12],
#         "angles": [0.0, 0.03157379551346526, 0.06314759102693052, 0.09472138654039577, 0.12629518205386103, 0.1578689775673263, 0.18944277308079155, 0.2210165685942568, 0.25259036410772207, 0.28416415962118735, 0.3157379551346526, 0.3473117506481178, 0.3788855461615831, 0.4104593416750484, 0.4420331371885136, 0.47360693270197884, 0.5051807282154441, 0.5367545237289094, 0.5683283192423747, 0.5999021147558399, 0.6314759102693052, 0.6630497057827704, 0.6946235012962356, 0.7261972968097009, 0.7577710923231662, 0.7893448878366315, 0.8209186833500968, 0.8524924788635619, 0.8840662743770272, 0.9156400698904925, 0.9472138654039577, 0.978787660917423, 1.0103614564308883, 1.0419352519443534, 1.0735090474578188, 1.105082842971284, 1.1366566384847494, 1.1682304339982146, 1.1998042295116798, 1.2313780250251452, 1.2629518205386103, 1.2945256160520755, 1.326099411565541, 1.357673207079006, 1.3892470025924712, 1.4208207981059366, 1.4523945936194018, 1.4839683891328672, 1.5155421846463324, 1.5471159801597976, 1.578689775673263, 1.6102635711867281, 1.6418373667001935, 1.6734111622136587, 1.7049849577271239, 1.7365587532405893, 1.7681325487540545, 1.7997063442675196, 1.831280139780985, 1.8628539352944502, 1.8944277308079154, 1.9260015263213808, 1.957575321834846, 1.9891491173483113, 2.0207229128617765, 2.0522967083752417, 2.083870503888707, 2.1154442994021725, 2.1470180949156377, 2.178591890429103, 2.210165685942568, 2.241739481456033, 2.273313276969499, 2.304887072482964, 2.336460867996429, 2.3680346635098943, 2.3996084590233595, 2.4311822545368247, 2.4627560500502903, 2.4943298455637555, 2.5259036410772207, 2.557477436590686, 2.589051232104151, 2.6206250276176166, 2.652198823131082, 2.683772618644547, 2.715346414158012, 2.7469202096714773, 2.7784940051849425, 2.810067800698408, 2.8416415962118733, 2.8732153917253385, 2.9047891872388036, 2.936362982752269, 2.9679367782657344, 2.9995105737791996, 3.031084369292665, 3.06265816480613, 3.094231960319595, 3.1258057558330608, 3.157379551346526, 3.188953346859991, 3.2205271423734563, 3.2521009378869215, 3.283674733400387, 3.3152485289138522, 3.3468223244273174, 3.3783961199407826, 3.4099699154542478, 3.441543710967713, 3.4731175064811786, 3.5046913019946437, 3.536265097508109, 3.567838893021574, 3.5994126885350393, 3.630986484048505, 3.66256027956197, 3.6941340750754352, 3.7257078705889004, 3.7572816661023656, 3.7888554616158308, 3.8204292571292964, 3.8520030526427615, 3.8835768481562267, 3.915150643669692, 3.946724439183157, 3.9782982346966227, 4.009872030210087, 4.041445825723553, 4.073019621237019, 4.104593416750483, 4.136167212263949, 4.167741007777414, 4.199314803290879, 4.230888598804345, 4.26246239431781, 4.294036189831275, 4.32560998534474, 4.357183780858206, 4.388757576371671, 4.420331371885136, 4.451905167398602, 4.483478962912066, 4.515052758425532, 4.546626553938998, 4.578200349452462, 4.609774144965928, 4.641347940479393, 4.672921735992858, 4.704495531506323, 4.736069327019789, 4.767643122533254, 4.799216918046719, 4.830790713560185, 4.862364509073649, 4.893938304587115, 4.925512100100581, 4.957085895614045, 4.988659691127511, 5.020233486640976, 5.051807282154441, 5.083381077667907, 5.114954873181372, 5.146528668694837, 5.178102464208302, 5.209676259721768, 5.241250055235233, 5.272823850748698, 5.304397646262164, 5.335971441775628, 5.367545237289094, 5.39911903280256, 5.430692828316024, 5.46226662382949, 5.493840419342955, 5.52541421485642, 5.556988010369885, 5.588561805883351, 5.620135601396816, 5.651709396910281, 5.683283192423747, 5.714856987937211, 5.746430783450677, 5.7780045789641425, 5.809578374477607, 5.841152169991073, 5.872725965504538, 5.904299761018003, 5.935873556531469, 5.967447352044934, 5.999021147558399, 6.030594943071864, 6.06216873858533, 6.093742534098795, 6.12531632961226, 6.1568901251257255, 6.18846392063919, 6.220037716152656, 6.2516115116661215, 6.283185307179586]
#     },
#     "Non-equivariant + circular": {
#         "losses": [0.0, 1.7926015516422922e-07, 5.636421747112763e-07, 8.802119282336207e-07, 9.000999625641271e-07, 7.959091021803033e-07, 8.004988103493815e-07, 9.090923072108126e-07, 1.117515694204485e-06, 1.4759173154743621e-06, 1.8402871546641109e-06, 1.9302040072943782e-06, 1.8419494836052763e-06, 1.7901145383802941e-06, 1.7280315205425723e-06, 1.5505123656112119e-06, 1.3462790775520261e-06, 1.3630294688482536e-06, 1.5151783827604959e-06, 1.5693332215960254e-06, 1.5662873238397879e-06, 1.63776462613896e-06, 1.7099409888032824e-06, 1.7386578292644117e-06, 1.8409712083666818e-06, 2.2162557797855698e-06, 2.5790855033847038e-06, 2.565358954598196e-06, 2.395581304881489e-06, 2.2942285795579664e-06, 2.1673297396773705e-06, 1.968749984371243e-06, 1.7239945009350777e-06, 1.5386460745503427e-06, 1.4480981462838827e-06, 1.4709836477777571e-06, 1.4841224356132443e-06, 1.428058340025018e-06, 1.4202870488588815e-06, 1.3703374861506745e-06, 1.3876876892027212e-06, 1.5776996633576346e-06, 1.9252895526733482e-06, 2.2985248051554663e-06, 2.4868231776054017e-06, 2.326109097339213e-06, 1.930732878463459e-06, 1.3804874470224604e-06, 6.711129572067875e-07, 1.3202875948081783e-07, 2.303718105167718e-08, 2.748247140971216e-07, 6.663489102720632e-07, 9.199267765325203e-07, 8.609489441369078e-07, 7.771058676553366e-07, 8.048234008128929e-07, 9.384226586917066e-07, 1.177503236249322e-06, 1.553275410515198e-06, 1.8753510175884003e-06, 1.9060694285144564e-06, 1.8087152966472786e-06, 1.7663151083979756e-06, 1.6798628621472744e-06, 1.4939779475753312e-06, 1.325762013948406e-06, 1.3999597285874188e-06, 1.5411649201269029e-06, 1.5687157883803593e-06, 1.5734322005300783e-06, 1.640812342884601e-06, 1.7262593701161677e-06, 1.7318113805231405e-06, 1.910834953378071e-06, 2.3322786546486896e-06, 2.622820602482534e-06, 2.52809240919305e-06, 2.361795395700028e-06, 2.256941570522031e-06, 2.1153314264665823e-06, 1.914270342240343e-06, 1.6589981441939017e-06, 1.4888682926539332e-06, 1.435031890650862e-06, 1.4589309103030246e-06, 1.4554298104485497e-06, 1.3930707609688397e-06, 1.386885287502082e-06, 1.3493296364686103e-06, 1.3992362255521584e-06, 1.6428709841420641e-06, 2.0272966594347963e-06, 2.373058578086784e-06, 2.5009635464812163e-06, 2.2678127606923226e-06, 1.818717578316864e-06, 1.221026536768477e-06, 4.997727955924347e-07, 6.329123891646304e-08, 6.357419835012479e-08, 3.7937843444524333e-07, 7.651680675735406e-07, 9.367993243358796e-07, 8.376600248993782e-07, 7.803363359926152e-07, 8.323665952048032e-07, 9.82460278464714e-07, 1.2509611906352802e-06, 1.6353810678992886e-06, 1.8978889784193598e-06, 1.8837508832802996e-06, 1.7866742609840003e-06, 1.7607158042665105e-06, 1.6479706346217426e-06, 1.4406944046641001e-06, 1.3389026207732968e-06, 1.4505894796457142e-06, 1.5533241821685806e-06, 1.5673483630962437e-06, 1.585543714099913e-06, 1.6774185951362597e-06, 1.7531550611238345e-06, 1.7638230929151177e-06, 1.9957515178248286e-06, 2.431702114336076e-06, 2.6147135940846056e-06, 2.4682080947968643e-06, 2.3210754989122506e-06, 2.192959527747007e-06, 2.0470633899094537e-06, 1.8261614513903623e-06, 1.598073595232563e-06, 1.452978949600947e-06, 1.4406268746824935e-06, 1.4685526821267558e-06, 1.438860863345326e-06, 1.3846685078533483e-06, 1.3578994639829034e-06, 1.3263090750115225e-06, 1.4228938880478381e-06, 1.7163835082101286e-06, 2.0996992589061847e-06, 2.414185019006254e-06, 2.45864885073388e-06, 2.1419032236735802e-06, 1.6840090211189818e-06, 1.0477314162926632e-06, 3.6591637808669475e-07, 2.4819184929469884e-08, 1.0976463471479292e-07, 4.6563670252908196e-07, 8.285378498840146e-07, 9.212101304001408e-07, 8.174296226570732e-07, 7.956519993967959e-07, 8.68518213792413e-07, 1.0460953490110114e-06, 1.3633346043206984e-06, 1.7514009869046276e-06, 1.932094846779364e-06, 1.8797117036228883e-06, 1.7868509303298197e-06, 1.7578842061993782e-06, 1.6102978861454176e-06, 1.394123046338791e-06, 1.3433664207695983e-06, 1.4744723557669204e-06, 1.5574872804791084e-06, 1.5561611235170858e-06, 1.597711388967582e-06, 1.692086698312778e-06, 1.7439001567254309e-06, 1.7985075828619301e-06, 2.0989218683098443e-06, 2.5309195734735113e-06, 2.6080153929797234e-06, 2.4367998321395135e-06, 2.310868694621604e-06, 2.184060122090159e-06, 2.0102777398278704e-06, 1.7724307781463722e-06, 1.5586763311148388e-06, 1.4556419500877382e-06, 1.4511014114759746e-06, 1.4815925624134252e-06, 1.4314457530417712e-06, 1.4093543541093823e-06, 1.3681253676622873e-06, 1.355446443085384e-06, 1.4917839052941417e-06, 1.8267951418238226e-06, 2.2055721728975186e-06, 2.459373263263842e-06, 2.3995651190489298e-06, 2.0282807327021146e-06, 1.5257443237715052e-06, 8.443878414254868e-07, 2.1939931116321532e-07, 1.244494772127203e-14],
#         "angles": [0.0, 0.03157379551346526, 0.06314759102693052, 0.09472138654039577, 0.12629518205386103, 0.1578689775673263, 0.18944277308079155, 0.2210165685942568, 0.25259036410772207, 0.28416415962118735, 0.3157379551346526, 0.3473117506481178, 0.3788855461615831, 0.4104593416750484, 0.4420331371885136, 0.47360693270197884, 0.5051807282154441, 0.5367545237289094, 0.5683283192423747, 0.5999021147558399, 0.6314759102693052, 0.6630497057827704, 0.6946235012962356, 0.7261972968097009, 0.7577710923231662, 0.7893448878366315, 0.8209186833500968, 0.8524924788635619, 0.8840662743770272, 0.9156400698904925, 0.9472138654039577, 0.978787660917423, 1.0103614564308883, 1.0419352519443534, 1.0735090474578188, 1.105082842971284, 1.1366566384847494, 1.1682304339982146, 1.1998042295116798, 1.2313780250251452, 1.2629518205386103, 1.2945256160520755, 1.326099411565541, 1.357673207079006, 1.3892470025924712, 1.4208207981059366, 1.4523945936194018, 1.4839683891328672, 1.5155421846463324, 1.5471159801597976, 1.578689775673263, 1.6102635711867281, 1.6418373667001935, 1.6734111622136587, 1.7049849577271239, 1.7365587532405893, 1.7681325487540545, 1.7997063442675196, 1.831280139780985, 1.8628539352944502, 1.8944277308079154, 1.9260015263213808, 1.957575321834846, 1.9891491173483113, 2.0207229128617765, 2.0522967083752417, 2.083870503888707, 2.1154442994021725, 2.1470180949156377, 2.178591890429103, 2.210165685942568, 2.241739481456033, 2.273313276969499, 2.304887072482964, 2.336460867996429, 2.3680346635098943, 2.3996084590233595, 2.4311822545368247, 2.4627560500502903, 2.4943298455637555, 2.5259036410772207, 2.557477436590686, 2.589051232104151, 2.6206250276176166, 2.652198823131082, 2.683772618644547, 2.715346414158012, 2.7469202096714773, 2.7784940051849425, 2.810067800698408, 2.8416415962118733, 2.8732153917253385, 2.9047891872388036, 2.936362982752269, 2.9679367782657344, 2.9995105737791996, 3.031084369292665, 3.06265816480613, 3.094231960319595, 3.1258057558330608, 3.157379551346526, 3.188953346859991, 3.2205271423734563, 3.2521009378869215, 3.283674733400387, 3.3152485289138522, 3.3468223244273174, 3.3783961199407826, 3.4099699154542478, 3.441543710967713, 3.4731175064811786, 3.5046913019946437, 3.536265097508109, 3.567838893021574, 3.5994126885350393, 3.630986484048505, 3.66256027956197, 3.6941340750754352, 3.7257078705889004, 3.7572816661023656, 3.7888554616158308, 3.8204292571292964, 3.8520030526427615, 3.8835768481562267, 3.915150643669692, 3.946724439183157, 3.9782982346966227, 4.009872030210087, 4.041445825723553, 4.073019621237019, 4.104593416750483, 4.136167212263949, 4.167741007777414, 4.199314803290879, 4.230888598804345, 4.26246239431781, 4.294036189831275, 4.32560998534474, 4.357183780858206, 4.388757576371671, 4.420331371885136, 4.451905167398602, 4.483478962912066, 4.515052758425532, 4.546626553938998, 4.578200349452462, 4.609774144965928, 4.641347940479393, 4.672921735992858, 4.704495531506323, 4.736069327019789, 4.767643122533254, 4.799216918046719, 4.830790713560185, 4.862364509073649, 4.893938304587115, 4.925512100100581, 4.957085895614045, 4.988659691127511, 5.020233486640976, 5.051807282154441, 5.083381077667907, 5.114954873181372, 5.146528668694837, 5.178102464208302, 5.209676259721768, 5.241250055235233, 5.272823850748698, 5.304397646262164, 5.335971441775628, 5.367545237289094, 5.39911903280256, 5.430692828316024, 5.46226662382949, 5.493840419342955, 5.52541421485642, 5.556988010369885, 5.588561805883351, 5.620135601396816, 5.651709396910281, 5.683283192423747, 5.714856987937211, 5.746430783450677, 5.7780045789641425, 5.809578374477607, 5.841152169991073, 5.872725965504538, 5.904299761018003, 5.935873556531469, 5.967447352044934, 5.999021147558399, 6.030594943071864, 6.06216873858533, 6.093742534098795, 6.12531632961226, 6.1568901251257255, 6.18846392063919, 6.220037716152656, 6.2516115116661215, 6.283185307179586]
#     },
#     "Non-equivariant + square": {
#         "losses": [0.0, 1.9341491963587032e-07, 6.751363343937555e-07, 1.2851287465309724e-06, 1.772054702087189e-06, 2.2292429093795363e-06, 2.81007010016765e-06, 3.4083968785125762e-06, 4.116034688195214e-06, 4.820942194783129e-06, 5.406761829362949e-06, 5.493726803251775e-06, 5.355387202143902e-06, 5.37824507773621e-06, 5.2911154853063636e-06, 5.118758053868078e-06, 5.292894456943031e-06, 5.779636921943165e-06, 6.25520169705851e-06, 6.3428078647120856e-06, 6.085655513743404e-06, 5.9056073951069266e-06, 6.028481038811151e-06, 5.896833499718923e-06, 5.8496520978224e-06, 6.251445483940188e-06, 6.587125426449347e-06, 6.271536221902352e-06, 5.846884050697554e-06, 5.52215396965039e-06, 5.342722033674363e-06, 5.155756753083551e-06, 4.976506716047879e-06, 4.806289325642865e-06, 4.752685526909772e-06, 4.646052730095107e-06, 4.310128133511171e-06, 3.856680905300891e-06, 3.4635741030797362e-06, 3.2144805572897894e-06, 3.2107243441714672e-06, 3.469282546575414e-06, 3.825606654572766e-06, 4.179728875897126e-06, 4.1765638343349565e-06, 3.6066226130060386e-06, 2.8969047889404465e-06, 2.047184125331114e-06, 9.656879456088063e-07, 1.8702201032283483e-07, 4.267409536851119e-08, 3.279214979556855e-07, 8.457265039396589e-07, 1.4406964510271791e-06, 1.8627260942594148e-06, 2.352998990318156e-06, 2.91322226075863e-06, 3.5601610761659686e-06, 4.326213456806727e-06, 5.010626864532242e-06, 5.56065924683935e-06, 5.546736247197259e-06, 5.413740382209653e-06, 5.463049092213623e-06, 5.326629434421193e-06, 5.161077297088923e-06, 5.440331733552739e-06, 5.9638327911670785e-06, 6.372220923367422e-06, 6.31464172329288e-06, 6.0495949583128095e-06, 5.9412468544906005e-06, 6.07981564826332e-06, 5.9032245189882815e-06, 5.925941877649166e-06, 6.3928864619811065e-06, 6.578064130735584e-06, 6.21112576482119e-06, 5.780224455520511e-06, 5.486725513037527e-06, 5.329789019015152e-06, 5.1483621064107865e-06, 4.928273483528756e-06, 4.7934067879396025e-06, 4.7413113861694e-06, 4.565899871522561e-06, 4.181325493846089e-06, 3.7308000173652545e-06, 3.3750670809240546e-06, 3.185373316227924e-06, 3.2605676096864045e-06, 3.5296684472996276e-06, 3.9041578929754905e-06, 4.173569323029369e-06, 4.067728696099948e-06, 3.432280664128484e-06, 2.667483158802497e-06, 1.7875269122669124e-06, 7.133628514566226e-07, 1.081088001342323e-07, 1.0137350869854345e-07, 4.6591347313551523e-07, 1.0196434914178099e-06, 1.5741829884063918e-06, 1.9782917206612183e-06, 2.4964811018435284e-06, 3.009660304087447e-06, 3.6847336559731048e-06, 4.4406906454241835e-06, 5.131903890287504e-06, 5.529285772354342e-06, 5.440050699689891e-06, 5.309851985657588e-06, 5.375166438170709e-06, 5.181163942324929e-06, 5.128179964231094e-06, 5.494689503393602e-06, 6.039409981895005e-06, 6.3240631789085455e-06, 6.192494765855372e-06, 5.938048161624465e-06, 5.921665433561429e-06, 6.00442126597045e-06, 5.825710104545578e-06, 5.935046374361264e-06, 6.4820333136594854e-06, 6.457216841226909e-06, 6.0286188272584695e-06, 5.6272342590091284e-06, 5.346037596609676e-06, 5.195785888645332e-06, 5.017877811042126e-06, 4.825551513931714e-06, 4.73444742965512e-06, 4.689659363066312e-06, 4.454943791643018e-06, 4.0111763155437075e-06, 3.5642717648443067e-06, 3.232240487704985e-06, 3.0809574127488304e-06, 3.224526153644547e-06, 3.5905916320189135e-06, 4.032551714772126e-06, 4.246733624313492e-06, 4.012547833553981e-06, 3.329576884425478e-06, 2.525198624425684e-06, 1.5321188584493939e-06, 5.076546472082555e-07, 5.03325345846406e-08, 1.3709295387798193e-07, 5.621171226266597e-07, 1.149353920482099e-06, 1.6777538576207007e-06, 2.10465486816247e-06, 2.6810571398527827e-06, 3.2108855521073565e-06, 3.9187134461826645e-06, 4.636808171198936e-06, 5.291987690725364e-06, 5.527787834580522e-06, 5.368512574932538e-06, 5.298400992614916e-06, 5.336614322004607e-06, 5.1304541557328776e-06, 5.211828920437256e-06, 5.616587259282824e-06, 6.12832900515059e-06, 6.317872703220928e-06, 6.115110409155022e-06, 5.863661499461159e-06, 5.945630164205795e-06, 5.928138307353947e-06, 5.80837695451919e-06, 6.051751370250713e-06, 6.5689669099811e-06, 6.379247224685969e-06, 5.9554340623435564e-06, 5.594435606326442e-06, 5.3813232625543606e-06, 5.224097549216822e-06, 5.02098328070133e-06, 4.8152396630030125e-06, 4.775515662913676e-06, 4.680649908550549e-06, 4.410403107613092e-06, 3.927075340470765e-06, 3.5024474982492393e-06, 3.186874891980551e-06, 3.093259238085011e-06, 3.3075530154746957e-06, 3.676260803331388e-06, 4.120693120057695e-06, 4.24562949774554e-06, 3.7936285934847547e-06, 3.0570752187486505e-06, 2.2268222892307676e-06, 1.1928750609513372e-06, 2.7905014121643035e-07, 2.0167366583147273e-14],
#         "angles": [0.0, 0.03157379551346526, 0.06314759102693052, 0.09472138654039577, 0.12629518205386103, 0.1578689775673263, 0.18944277308079155, 0.2210165685942568, 0.25259036410772207, 0.28416415962118735, 0.3157379551346526, 0.3473117506481178, 0.3788855461615831, 0.4104593416750484, 0.4420331371885136, 0.47360693270197884, 0.5051807282154441, 0.5367545237289094, 0.5683283192423747, 0.5999021147558399, 0.6314759102693052, 0.6630497057827704, 0.6946235012962356, 0.7261972968097009, 0.7577710923231662, 0.7893448878366315, 0.8209186833500968, 0.8524924788635619, 0.8840662743770272, 0.9156400698904925, 0.9472138654039577, 0.978787660917423, 1.0103614564308883, 1.0419352519443534, 1.0735090474578188, 1.105082842971284, 1.1366566384847494, 1.1682304339982146, 1.1998042295116798, 1.2313780250251452, 1.2629518205386103, 1.2945256160520755, 1.326099411565541, 1.357673207079006, 1.3892470025924712, 1.4208207981059366, 1.4523945936194018, 1.4839683891328672, 1.5155421846463324, 1.5471159801597976, 1.578689775673263, 1.6102635711867281, 1.6418373667001935, 1.6734111622136587, 1.7049849577271239, 1.7365587532405893, 1.7681325487540545, 1.7997063442675196, 1.831280139780985, 1.8628539352944502, 1.8944277308079154, 1.9260015263213808, 1.957575321834846, 1.9891491173483113, 2.0207229128617765, 2.0522967083752417, 2.083870503888707, 2.1154442994021725, 2.1470180949156377, 2.178591890429103, 2.210165685942568, 2.241739481456033, 2.273313276969499, 2.304887072482964, 2.336460867996429, 2.3680346635098943, 2.3996084590233595, 2.4311822545368247, 2.4627560500502903, 2.4943298455637555, 2.5259036410772207, 2.557477436590686, 2.589051232104151, 2.6206250276176166, 2.652198823131082, 2.683772618644547, 2.715346414158012, 2.7469202096714773, 2.7784940051849425, 2.810067800698408, 2.8416415962118733, 2.8732153917253385, 2.9047891872388036, 2.936362982752269, 2.9679367782657344, 2.9995105737791996, 3.031084369292665, 3.06265816480613, 3.094231960319595, 3.1258057558330608, 3.157379551346526, 3.188953346859991, 3.2205271423734563, 3.2521009378869215, 3.283674733400387, 3.3152485289138522, 3.3468223244273174, 3.3783961199407826, 3.4099699154542478, 3.441543710967713, 3.4731175064811786, 3.5046913019946437, 3.536265097508109, 3.567838893021574, 3.5994126885350393, 3.630986484048505, 3.66256027956197, 3.6941340750754352, 3.7257078705889004, 3.7572816661023656, 3.7888554616158308, 3.8204292571292964, 3.8520030526427615, 3.8835768481562267, 3.915150643669692, 3.946724439183157, 3.9782982346966227, 4.009872030210087, 4.041445825723553, 4.073019621237019, 4.104593416750483, 4.136167212263949, 4.167741007777414, 4.199314803290879, 4.230888598804345, 4.26246239431781, 4.294036189831275, 4.32560998534474, 4.357183780858206, 4.388757576371671, 4.420331371885136, 4.451905167398602, 4.483478962912066, 4.515052758425532, 4.546626553938998, 4.578200349452462, 4.609774144965928, 4.641347940479393, 4.672921735992858, 4.704495531506323, 4.736069327019789, 4.767643122533254, 4.799216918046719, 4.830790713560185, 4.862364509073649, 4.893938304587115, 4.925512100100581, 4.957085895614045, 4.988659691127511, 5.020233486640976, 5.051807282154441, 5.083381077667907, 5.114954873181372, 5.146528668694837, 5.178102464208302, 5.209676259721768, 5.241250055235233, 5.272823850748698, 5.304397646262164, 5.335971441775628, 5.367545237289094, 5.39911903280256, 5.430692828316024, 5.46226662382949, 5.493840419342955, 5.52541421485642, 5.556988010369885, 5.588561805883351, 5.620135601396816, 5.651709396910281, 5.683283192423747, 5.714856987937211, 5.746430783450677, 5.7780045789641425, 5.809578374477607, 5.841152169991073, 5.872725965504538, 5.904299761018003, 5.935873556531469, 5.967447352044934, 5.999021147558399, 6.030594943071864, 6.06216873858533, 6.093742534098795, 6.12531632961226, 6.1568901251257255, 6.18846392063919, 6.220037716152656, 6.2516115116661215, 6.283185307179586]
#     }
# }


data_dict = {
    "SO(3) invariant + circular": {
        "losses": [0.0, 2.7751968900702195e-07, 8.425547548540635e-07, 1.2878533652838087e-06, 1.2553589385788655e-06, 1.0605143643260817e-06, 1.0943348343062098e-06, 1.3362030131247593e-06, 1.7351580936519895e-06, 2.342067773497547e-06, 2.909166141762398e-06, 3.0079020234552445e-06, 2.772637344605755e-06, 2.6783714019984473e-06, 2.6251570943713887e-06, 2.330491042812355e-06, 1.984528580578626e-06, 1.984218670258997e-06, 2.17800993596029e-06, 2.17844853978022e-06, 2.077720864690491e-06, 2.1047208065283485e-06, 2.191069597756723e-06, 2.225278421974508e-06, 2.3382262952509336e-06, 2.8285458029131405e-06, 3.3589817576284986e-06, 3.451244310781476e-06, 3.3793883176258532e-06, 3.256304353271844e-06, 3.0055489332880825e-06, 2.7205533115193248e-06, 2.3759719169902382e-06, 2.1457483398990007e-06, 2.0590887288562953e-06, 2.1267946976877283e-06, 2.2035678739484865e-06, 2.174407654820243e-06, 2.158886672987137e-06, 2.077622411889024e-06, 2.098724735333235e-06, 2.3364136723103e-06, 2.7680503080773633e-06, 3.297826879133936e-06, 3.6042724786966573e-06, 3.451909606155823e-06, 2.9698280741286e-06, 2.1791927338199457e-06, 1.0706003195082303e-06, 1.9636614467799518e-07, 2.1343915079796716e-08, 4.094106884622306e-07, 9.83792460829136e-07, 1.331874727839022e-06, 1.1893862392753363e-06, 1.0482231118658092e-06, 1.1315132724121213e-06, 1.4207453205017373e-06, 1.8673033537197625e-06, 2.5017961888806894e-06, 2.986273557326058e-06, 2.963234237540746e-06, 2.724561454670038e-06, 2.6678485482989345e-06, 2.5603192170819966e-06, 2.2346237074089004e-06, 1.9450935724307783e-06, 2.026233005381073e-06, 2.211684204667108e-06, 2.1517901132028783e-06, 2.0708603187813424e-06, 2.1151774944883073e-06, 2.218750069005182e-06, 2.213746938650729e-06, 2.4184676021832274e-06, 2.9777063446090324e-06, 3.4266836337337736e-06, 3.43260421686864e-06, 3.35563004227879e-06, 3.1932993351801997e-06, 2.933532641691272e-06, 2.647054316184949e-06, 2.308424427610589e-06, 2.107349700963823e-06, 2.0725228750961833e-06, 2.1507730707526207e-06, 2.1992566416884074e-06, 2.1600462787318975e-06, 2.138038325938396e-06, 2.0746256268466823e-06, 2.143165602319641e-06, 2.419673364784103e-06, 2.907620455516735e-06, 3.4011745810857974e-06, 3.62037144441274e-06, 3.369287014720612e-06, 2.7915946247958345e-06, 1.9278309082437772e-06, 7.998607998160878e-07, 8.948123308982758e-08, 7.689051528814161e-08, 5.520991521734686e-07, 1.1089753115811618e-06, 1.328687289969821e-06, 1.1350342674631975e-06, 1.0550650131335715e-06, 1.1916597486560931e-06, 1.5125714298847015e-06, 2.0133279576839413e-06, 2.6543041258264566e-06, 3.0325131774588954e-06, 2.9097927836119197e-06, 2.685998879314866e-06, 2.655086746017332e-06, 2.4928881430241745e-06, 2.1335827113944106e-06, 1.957330368895782e-06, 2.097678816426196e-06, 2.2074727894505486e-06, 2.1261571419017855e-06, 2.0586144273693208e-06, 2.143490746675525e-06, 2.23490565076645e-06, 2.2366348275681958e-06, 2.525697254895931e-06, 3.1381337066704873e-06, 3.464070005065878e-06, 3.4148781651310856e-06, 3.335540441185003e-06, 3.118865151918726e-06, 2.8568367724801647e-06, 2.5483027457084972e-06, 2.2403128241421655e-06, 2.0751863303303253e-06, 2.0943707568221726e-06, 2.1770479179394897e-06, 2.1874013782507973e-06, 2.16507737604843e-06, 2.1151222426851746e-06, 2.061448412860045e-06, 2.1875200673093786e-06, 2.5324698071926832e-06, 3.03664251077862e-06, 3.4994845918845385e-06, 3.608030056057032e-06, 3.2422999538539443e-06, 2.6227962734992616e-06, 1.6503392998856725e-06, 5.623776928587176e-07, 2.1809221095736575e-08, 1.622810543722153e-07, 6.979871614021249e-07, 1.2127695754315937e-06, 1.296361460845219e-06, 1.0926937648036983e-06, 1.076926309906412e-06, 1.2588327535922872e-06, 1.6176001054191147e-06, 2.1718153675465146e-06, 2.7844193937198725e-06, 3.0338378564920276e-06, 2.842296680682921e-06, 2.667240323717124e-06, 2.6494958547118586e-06, 2.421863428025972e-06, 2.0541435787890805e-06, 1.9682013316923985e-06, 2.136881903425092e-06, 2.1991700123180635e-06, 2.1048886083008256e-06, 2.0707084331661463e-06, 2.175023837480694e-06, 2.232901351817418e-06, 2.277253997817752e-06, 2.6531292860454414e-06, 3.2572556847298983e-06, 3.4645549931155983e-06, 3.3928390621440485e-06, 3.300771368230926e-06, 3.0669893931190018e-06, 2.7955450150329852e-06, 2.4577284420956858e-06, 2.183303877245635e-06, 2.0653610590670723e-06, 2.0982940895919455e-06, 2.187080553994747e-06, 2.1707508039980894e-06, 2.16518765228102e-06, 2.092828481181641e-06, 2.073733412544243e-06, 2.2546907985088183e-06, 2.658301582414424e-06, 3.1786621548235416e-06, 3.563931841199519e-06, 3.545686240613577e-06, 3.110810212092474e-06, 2.4121711703628534e-06, 1.358051918032288e-06, 3.5312930890540883e-07, 8.429225504711594e-15],
        "angles": [0.0, 0.03157379551346526, 0.06314759102693052, 0.09472138654039577, 0.12629518205386103, 0.1578689775673263, 0.18944277308079155, 0.2210165685942568, 0.25259036410772207, 0.28416415962118735, 0.3157379551346526, 0.3473117506481178, 0.3788855461615831, 0.4104593416750484, 0.4420331371885136, 0.47360693270197884, 0.5051807282154441, 0.5367545237289094, 0.5683283192423747, 0.5999021147558399, 0.6314759102693052, 0.6630497057827704, 0.6946235012962356, 0.7261972968097009, 0.7577710923231662, 0.7893448878366315, 0.8209186833500968, 0.8524924788635619, 0.8840662743770272, 0.9156400698904925, 0.9472138654039577, 0.978787660917423, 1.0103614564308883, 1.0419352519443534, 1.0735090474578188, 1.105082842971284, 1.1366566384847494, 1.1682304339982146, 1.1998042295116798, 1.2313780250251452, 1.2629518205386103, 1.2945256160520755, 1.326099411565541, 1.357673207079006, 1.3892470025924712, 1.4208207981059366, 1.4523945936194018, 1.4839683891328672, 1.5155421846463324, 1.5471159801597976, 1.578689775673263, 1.6102635711867281, 1.6418373667001935, 1.6734111622136587, 1.7049849577271239, 1.7365587532405893, 1.7681325487540545, 1.7997063442675196, 1.831280139780985, 1.8628539352944502, 1.8944277308079154, 1.9260015263213808, 1.957575321834846, 1.9891491173483113, 2.0207229128617765, 2.0522967083752417, 2.083870503888707, 2.1154442994021725, 2.1470180949156377, 2.178591890429103, 2.210165685942568, 2.241739481456033, 2.273313276969499, 2.304887072482964, 2.336460867996429, 2.3680346635098943, 2.3996084590233595, 2.4311822545368247, 2.4627560500502903, 2.4943298455637555, 2.5259036410772207, 2.557477436590686, 2.589051232104151, 2.6206250276176166, 2.652198823131082, 2.683772618644547, 2.715346414158012, 2.7469202096714773, 2.7784940051849425, 2.810067800698408, 2.8416415962118733, 2.8732153917253385, 2.9047891872388036, 2.936362982752269, 2.9679367782657344, 2.9995105737791996, 3.031084369292665, 3.06265816480613, 3.094231960319595, 3.1258057558330608, 3.157379551346526, 3.188953346859991, 3.2205271423734563, 3.2521009378869215, 3.283674733400387, 3.3152485289138522, 3.3468223244273174, 3.3783961199407826, 3.4099699154542478, 3.441543710967713, 3.4731175064811786, 3.5046913019946437, 3.536265097508109, 3.567838893021574, 3.5994126885350393, 3.630986484048505, 3.66256027956197, 3.6941340750754352, 3.7257078705889004, 3.7572816661023656, 3.7888554616158308, 3.8204292571292964, 3.8520030526427615, 3.8835768481562267, 3.915150643669692, 3.946724439183157, 3.9782982346966227, 4.009872030210087, 4.041445825723553, 4.073019621237019, 4.104593416750483, 4.136167212263949, 4.167741007777414, 4.199314803290879, 4.230888598804345, 4.26246239431781, 4.294036189831275, 4.32560998534474, 4.357183780858206, 4.388757576371671, 4.420331371885136, 4.451905167398602, 4.483478962912066, 4.515052758425532, 4.546626553938998, 4.578200349452462, 4.609774144965928, 4.641347940479393, 4.672921735992858, 4.704495531506323, 4.736069327019789, 4.767643122533254, 4.799216918046719, 4.830790713560185, 4.862364509073649, 4.893938304587115, 4.925512100100581, 4.957085895614045, 4.988659691127511, 5.020233486640976, 5.051807282154441, 5.083381077667907, 5.114954873181372, 5.146528668694837, 5.178102464208302, 5.209676259721768, 5.241250055235233, 5.272823850748698, 5.304397646262164, 5.335971441775628, 5.367545237289094, 5.39911903280256, 5.430692828316024, 5.46226662382949, 5.493840419342955, 5.52541421485642, 5.556988010369885, 5.588561805883351, 5.620135601396816, 5.651709396910281, 5.683283192423747, 5.714856987937211, 5.746430783450677, 5.7780045789641425, 5.809578374477607, 5.841152169991073, 5.872725965504538, 5.904299761018003, 5.935873556531469, 5.967447352044934, 5.999021147558399, 6.030594943071864, 6.06216873858533, 6.093742534098795, 6.12531632961226, 6.1568901251257255, 6.18846392063919, 6.220037716152656, 6.2516115116661215, 6.283185307179586]
    },
    "Non-equivariant + circular": {
        "losses": [0.0, 1.792615336171366e-07, 5.636336481984472e-07, 8.801989110907016e-07, 9.000859790830873e-07, 7.958980177136254e-07, 8.005068821148598e-07, 9.090778689824219e-07, 1.1174782912348746e-06, 1.475882640988857e-06, 1.8402540717943339e-06, 1.930170128616737e-06, 1.8419391381030437e-06, 1.7900658804137493e-06, 1.7280017345910892e-06, 1.5504577959291055e-06, 1.346263616142096e-06, 1.3630074136017356e-06, 1.5151613297348376e-06, 1.5692760371166514e-06, 1.5663119938835735e-06, 1.6377575775550213e-06, 1.709956222839537e-06, 1.738649530125258e-06, 1.8409963331578183e-06, 2.2162516870594118e-06, 2.579084593890002e-06, 2.5653571356087923e-06, 2.3956042696227087e-06, 2.2942208488530014e-06, 2.1672963157470804e-06, 1.968694505194435e-06, 1.7239899534615688e-06, 1.538648803034448e-06, 1.448095190426102e-06, 1.4709545439473004e-06, 1.484078893554397e-06, 1.4280691402746015e-06, 1.4202830698195612e-06, 1.3703271406484419e-06, 1.3876770026399754e-06, 1.5776911368448054e-06, 1.9252922811574535e-06, 2.298504114151001e-06, 2.4868045329640154e-06, 2.326109097339213e-06, 1.9307340153318364e-06, 1.3804940408590483e-06, 6.711123887725989e-07, 1.3203123216953827e-07, 2.3031272888829335e-08, 2.748232077465218e-07, 6.663317435595673e-07, 9.199252417602111e-07, 8.609393375991203e-07, 7.770909178361762e-07, 8.047879305195238e-07, 9.384003192280943e-07, 1.1774320682889083e-06, 1.5532511952187633e-06, 1.875313955679303e-06, 1.906071588564373e-06, 1.8086889213009272e-06, 1.7662705431575887e-06, 1.679841830082296e-06, 1.4939726042939583e-06, 1.325781227023981e-06, 1.3999397197039798e-06, 1.5411696949740872e-06, 1.5687224959037849e-06, 1.573431063661701e-06, 1.6408223473263206e-06, 1.7262436813325621e-06, 1.7318212712780223e-06, 1.910834953378071e-06, 2.3322750166698825e-06, 2.6227705802739365e-06, 2.5280178306275047e-06, 2.361783572268905e-06, 2.2568819986190647e-06, 2.1152745830477215e-06, 1.9142573819408426e-06, 1.6589674487477168e-06, 1.4888546502334066e-06, 1.4350566743814852e-06, 1.4589182910640375e-06, 1.4554491372109624e-06, 1.3930794011685066e-06, 1.386877556797117e-06, 1.349293029306864e-06, 1.399227812726167e-06, 1.642873485252494e-06, 2.027284608629998e-06, 2.373022653046064e-06, 2.500936261640163e-06, 2.267822765134042e-06, 1.8187256500823423e-06, 1.2210310842419858e-06, 4.997733071832045e-07, 6.329220525458368e-08, 6.356031434506804e-08, 3.7936843000352383e-07, 7.651660212104616e-07, 9.367788607050898e-07, 8.376354116990115e-07, 7.803070616319019e-07, 8.323547717736801e-07, 9.82431743068446e-07, 1.2509140105976257e-06, 1.6353567389160162e-06, 1.8978432763105957e-06, 1.8837308743968606e-06, 1.7866248072095914e-06, 1.7606992059882032e-06, 1.647985641284322e-06, 1.440668711438775e-06, 1.3388867046160158e-06, 1.4505939134323853e-06, 1.553320771563449e-06, 1.5673464304200024e-06, 1.5855316632951144e-06, 1.677411546552321e-06, 1.7531690446048742e-06, 1.7638567442190833e-06, 1.9957569747930393e-06, 2.43167846747383e-06, 2.614699951664079e-06, 2.4681844479346182e-06, 2.3210559447761625e-06, 2.192944521084428e-06, 2.0470561139518395e-06, 1.8261513332618051e-06, 1.5980411944838124e-06, 1.452969627280254e-06, 1.4405985666599008e-06, 1.4685516589452163e-06, 1.4388778026841464e-06, 1.3846724868926685e-06, 1.357882865704596e-06, 1.3263119171824655e-06, 1.4229199223336764e-06, 1.716364181447716e-06, 2.099675384670263e-06, 2.4141820631484734e-06, 2.458645212755073e-06, 2.141860477422597e-06, 1.6839854879435734e-06, 1.0477530167918303e-06, 3.6592302876670146e-07, 2.4820661082003426e-08, 1.0975514896927052e-07, 4.656252485801815e-07, 8.285475132652209e-07, 9.211918836626865e-07, 8.174205277100555e-07, 7.9562335031369e-07, 8.685190664436959e-07, 1.0460814792168094e-06, 1.3633178923555533e-06, 1.751357103785267e-06, 1.9320241335663013e-06, 1.8797014718074934e-06, 1.786796929081902e-06, 1.7578695405973122e-06, 1.6102865174616454e-06, 1.3940962162450887e-06, 1.3433552794595016e-06, 1.474453711125534e-06, 1.5574705685139634e-06, 1.556149982206989e-06, 1.5977111615939066e-06, 1.6920635061978828e-06, 1.7439338080293965e-06, 1.7985041722567985e-06, 2.0989018594264053e-06, 2.5308895601483528e-06, 2.6080399493366713e-06, 2.4368148388020927e-06, 2.3108382265490945e-06, 2.1840630779479397e-06, 2.0102368125662906e-06, 1.7723873497743625e-06, 1.5586726931360317e-06, 1.4556483165506506e-06, 1.4510915207210928e-06, 1.481610979681136e-06, 1.4314388181446702e-06, 1.409347532899119e-06, 1.3681431028089719e-06, 1.3554513316194061e-06, 1.4917779935785802e-06, 1.8268041230840026e-06, 2.2055792214814574e-06, 2.4593487069068942e-06, 2.3995794435904827e-06, 2.028274366239202e-06, 1.5257585346262204e-06, 8.444188779321848e-07, 2.1942410910469334e-07, 1.1173702886340883e-14],
        "angles": [0.0, 0.03157379551346526, 0.06314759102693052, 0.09472138654039577, 0.12629518205386103, 0.1578689775673263, 0.18944277308079155, 0.2210165685942568, 0.25259036410772207, 0.28416415962118735, 0.3157379551346526, 0.3473117506481178, 0.3788855461615831, 0.4104593416750484, 0.4420331371885136, 0.47360693270197884, 0.5051807282154441, 0.5367545237289094, 0.5683283192423747, 0.5999021147558399, 0.6314759102693052, 0.6630497057827704, 0.6946235012962356, 0.7261972968097009, 0.7577710923231662, 0.7893448878366315, 0.8209186833500968, 0.8524924788635619, 0.8840662743770272, 0.9156400698904925, 0.9472138654039577, 0.978787660917423, 1.0103614564308883, 1.0419352519443534, 1.0735090474578188, 1.105082842971284, 1.1366566384847494, 1.1682304339982146, 1.1998042295116798, 1.2313780250251452, 1.2629518205386103, 1.2945256160520755, 1.326099411565541, 1.357673207079006, 1.3892470025924712, 1.4208207981059366, 1.4523945936194018, 1.4839683891328672, 1.5155421846463324, 1.5471159801597976, 1.578689775673263, 1.6102635711867281, 1.6418373667001935, 1.6734111622136587, 1.7049849577271239, 1.7365587532405893, 1.7681325487540545, 1.7997063442675196, 1.831280139780985, 1.8628539352944502, 1.8944277308079154, 1.9260015263213808, 1.957575321834846, 1.9891491173483113, 2.0207229128617765, 2.0522967083752417, 2.083870503888707, 2.1154442994021725, 2.1470180949156377, 2.178591890429103, 2.210165685942568, 2.241739481456033, 2.273313276969499, 2.304887072482964, 2.336460867996429, 2.3680346635098943, 2.3996084590233595, 2.4311822545368247, 2.4627560500502903, 2.4943298455637555, 2.5259036410772207, 2.557477436590686, 2.589051232104151, 2.6206250276176166, 2.652198823131082, 2.683772618644547, 2.715346414158012, 2.7469202096714773, 2.7784940051849425, 2.810067800698408, 2.8416415962118733, 2.8732153917253385, 2.9047891872388036, 2.936362982752269, 2.9679367782657344, 2.9995105737791996, 3.031084369292665, 3.06265816480613, 3.094231960319595, 3.1258057558330608, 3.157379551346526, 3.188953346859991, 3.2205271423734563, 3.2521009378869215, 3.283674733400387, 3.3152485289138522, 3.3468223244273174, 3.3783961199407826, 3.4099699154542478, 3.441543710967713, 3.4731175064811786, 3.5046913019946437, 3.536265097508109, 3.567838893021574, 3.5994126885350393, 3.630986484048505, 3.66256027956197, 3.6941340750754352, 3.7257078705889004, 3.7572816661023656, 3.7888554616158308, 3.8204292571292964, 3.8520030526427615, 3.8835768481562267, 3.915150643669692, 3.946724439183157, 3.9782982346966227, 4.009872030210087, 4.041445825723553, 4.073019621237019, 4.104593416750483, 4.136167212263949, 4.167741007777414, 4.199314803290879, 4.230888598804345, 4.26246239431781, 4.294036189831275, 4.32560998534474, 4.357183780858206, 4.388757576371671, 4.420331371885136, 4.451905167398602, 4.483478962912066, 4.515052758425532, 4.546626553938998, 4.578200349452462, 4.609774144965928, 4.641347940479393, 4.672921735992858, 4.704495531506323, 4.736069327019789, 4.767643122533254, 4.799216918046719, 4.830790713560185, 4.862364509073649, 4.893938304587115, 4.925512100100581, 4.957085895614045, 4.988659691127511, 5.020233486640976, 5.051807282154441, 5.083381077667907, 5.114954873181372, 5.146528668694837, 5.178102464208302, 5.209676259721768, 5.241250055235233, 5.272823850748698, 5.304397646262164, 5.335971441775628, 5.367545237289094, 5.39911903280256, 5.430692828316024, 5.46226662382949, 5.493840419342955, 5.52541421485642, 5.556988010369885, 5.588561805883351, 5.620135601396816, 5.651709396910281, 5.683283192423747, 5.714856987937211, 5.746430783450677, 5.7780045789641425, 5.809578374477607, 5.841152169991073, 5.872725965504538, 5.904299761018003, 5.935873556531469, 5.967447352044934, 5.999021147558399, 6.030594943071864, 6.06216873858533, 6.093742534098795, 6.12531632961226, 6.1568901251257255, 6.18846392063919, 6.220037716152656, 6.2516115116661215, 6.283185307179586]
    }
}



i = 0
for key, val in data_dict.items():
    ax.plot(val["angles"], val["losses"], c=colors[i], lw=lw, label=key)
    i += 1

#         print(item["global_step"])

# invariance_loss, angles = history[-1]["invariance_loss"], history[-1]["angles"]

# ax.plot(angles, losses, c=colors[0], lw=lw, label=r"$SO(3)$ Invariant")

# non-equivariant model
# run = api.run("ck-experimental/dense_point_clouds/7jrby70e")

# history = run.scan_history()
#
# for item in history:
#     if hasattr(item, "epoch"):
#         if item["epoch"] is not None:
#             epoch = item["epoch"]
#             if epoch == "26" or epoch == 26:
#                 break
#     if item["invariance_loss"] is not None:
#         losses = item["invariance_loss"]
#         angles = item["angles"]
#
# ax.plot(angles, losses, c=colors[1], lw=lw, label=r"Non-equivariant")

ax.set_xticks([0.0, 0.5*np.pi, np.pi, 1.5*np.pi, 2*np.pi], labels=[r"$0$", r"$\frac{1}{2}\pi$", r"$\pi$", r"$\frac{3}{2}\pi$", r"$2\pi$"], fontsize=fontsize)
plt.grid()
plt.yticks(fontsize=fontsize)
ax.legend(fontsize=fontsize)
plt.xlim(0.0, 2*np.pi)


plt.show()

# circle = np.linspace(0, 2*np.pi, 100)
#
# fig = plt.figure()
# plt.plot(np.cos(circle), np.sin(circle), c="red")
#
# start_x = np.cos(0.0)
# start_y = np.sin(0.0)
#
# for loss, angle in zip(losses, angles):
#
#     x = np.cos(angle) * (1+loss)
#     y = np.sin(angle) * (1+loss)
#
#     plt.plot([start_x, x], [start_y, y], c="blue")
#
#     start_x = x
#     start_y = y
#
# plt.show()
# print(losses)

# print(epoch)
# plt.plot(angles, invariance_loss)
# plt.show()

